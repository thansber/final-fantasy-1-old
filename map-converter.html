<html>
<head>
<style>
#old { width:36em; height:30em; margin-right:1em; margin-bottom: 1em;float:left; }
#new { width:68em; height:30em; float:left; }
button { clear: both; float:left; margin-bottom: 0.4em;}
</style>
</head>
<body>
<textarea id="old"></textarea>
<textarea id="new"></textarea>
<button id="convert">Convert</button>
<button id="spacify">Spacify</button>
<script src="js/lib/jquery.min.js"></script>
<script>
$(document).ready(function() {

  var mapping = {
      " " : ".",
      "." : "..",
      "a" : "an",
      "c" : "Rc",
      "f" : "fg",
      "h" : "hm",
      "m" : "^",
      "n" : "^^",
      "p" : "Rp",
      "r" : "R",
      "s" : "sw",
      "A" : "bt",
      "B" : "bb",
      "C" : "RC",
      "D" : "D",
      "J" : "R1",
      "K" : "R2",
      "L" : "R3",
      "M" : "R4",
      "N" : "R5",
      "O" : "R6",
      "P" : "R7",
      "Q" : "R8",
      "R" : "W",
      "T" : "Rt",
      "U" : "W1",
      "V" : "W3",
      "W" : "W",
      "X" : "W4",
      "Y" : "W2",
      ">" : ">",
      "<" : "<"
  };
  
  $("#convert").click(function() {

    var newMap = [];
    var oldMap = JSON.parse($("#old").val());
    
    for (var i = 0; i < oldMap.length; i++) {
      var line = oldMap[i];
      var newLine = "";
      
      for (var j = 0; j < line.length; j++) {
        var tile = line.charAt(j);
        var newTile = mapping[tile];
        if (!newTile) {
          console.warn("no mapping found for [" + tile + "]");
        } else {
          newLine += newTile + (newTile.length === 1 ? "  " : " ");
        }
      }
      
      newMap.push(newLine);
    }

    
    $("#new").val(".sprites(\"" + newMap.join("\")\n.sprites(\"") + "\")");
    return false;
  });
  
  $("#spacify").click(function() {
    var old = $("#old").val().split("\n");
    var line = "";
    var s = [];
    
    for (var i = 0; i < old.length; i++) {
      line = old[i].trim();
      for (var c = 0; c < line.length; c++) {
        var ch = line.charAt(c);
        if (ch === ",") {
          s.push(".sprites(");
        } else if (ch === "\"") {
          s.push(ch);
          if (c === line.length - 1) {
            s.push(")\n");
          }
        } else if (ch === " ") {
          s.push(".  ");
        } else {
          s.push(ch);
          if (c < line.length - 2) {
            s.push("  ");
          }
        }
      }
    }
    
    $("#new").val(s.join(""));
  })

});
</script>
</body>
</html>